<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Jianfeng Li" />

<meta name="date" content="2017-07-18" />

<title>Usage of configr</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">Usage of configr</h1>
<h4 class="author"><em>Jianfeng Li</em></h4>
<h4 class="date"><em>2017-07-18</em></h4>



<p>configr is an integrated parser package that json, ini, yaml and toml format files can now be processed. The vignette will walk you through the basics of using configr to extend existing parser in R.</p>
<div id="built-in-examples-of-configuration-file" class="section level2">
<h2>Built-in examples of configuration file</h2>
<p>Example of json, ini, yaml, toml can be used follow the instructions below.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(configr)
config.json &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">'extdata'</span>, <span class="st">'config.json'</span>, <span class="dt">package=</span><span class="st">'configr'</span>)
config.ini &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">'extdata'</span>, <span class="st">'config.ini'</span>, <span class="dt">package=</span><span class="st">'configr'</span>)
config.yaml &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">'extdata'</span>, <span class="st">'config.yaml'</span>, <span class="dt">package=</span><span class="st">'configr'</span>)
config.toml &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">'extdata'</span>, <span class="st">'config.toml'</span>, <span class="dt">package=</span><span class="st">'configr'</span>)</code></pre></div>
</div>
<div id="check-the-configuration-file-type" class="section level2">
<h2>Check the configuration file type</h2>
<p><code>is.json.file</code>, <code>is.ini.file</code>, <code>is.yaml.file</code> and <code>is.toml.file</code> can be used to check the configuration file type. If input file were coincident with required, it will return TRUE. <code>get.config.type</code> will using above functions and get the file type name: json, ini, yaml, toml or FALSE.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">is.json.file</span>(config.json)
<span class="co">#&gt; [1] TRUE</span>
<span class="kw">is.toml.file</span>(config.toml)
<span class="co">#&gt; [1] TRUE</span>
<span class="kw">is.ini.file</span>(config.ini)
<span class="co">#&gt; [1] TRUE</span>
<span class="kw">is.yaml.file</span>(config.yaml)
<span class="co">#&gt; [1] TRUE</span>
<span class="kw">get.config.type</span>(config.json)
<span class="co">#&gt; [1] &quot;json&quot;</span>
<span class="kw">get.config.type</span>(config.yaml)
<span class="co">#&gt; [1] &quot;yaml&quot;</span>
<span class="kw">get.config.type</span>(config.ini)
<span class="co">#&gt; [1] &quot;ini&quot;</span>
<span class="kw">get.config.type</span>(config.toml)
<span class="co">#&gt; [1] &quot;toml&quot;</span></code></pre></div>
</div>
<div id="get-the-configuration-section-names" class="section level2">
<h2>Get the configuration section names</h2>
<p>Section names of configuration file can be get using <code>eval.config.sections</code>. Python package <a href="https://pypi.python.org/pypi/configparser">ConfigParser</a> <code>sections</code> inspired us to add this function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">eval.config.sections</span>(config.ini)
<span class="co">#&gt; [1] &quot;default&quot;            &quot;comments&quot;           &quot;extra_list_parse&quot;  </span>
<span class="co">#&gt; [4] &quot;other_config_parse&quot; &quot;rcmd_parse&quot;         &quot;bash_parse&quot;        </span>
<span class="co">#&gt; [7] &quot;mulitple_parse&quot;     &quot;glue_parse&quot;</span>
<span class="kw">eval.config.sections</span>(config.toml)
<span class="co">#&gt; [1] &quot;bash_parse&quot;         &quot;comments&quot;           &quot;default&quot;           </span>
<span class="co">#&gt; [4] &quot;extra_list_parse&quot;   &quot;glue_parse&quot;         &quot;mulitple_parse&quot;    </span>
<span class="co">#&gt; [7] &quot;other_config_parse&quot; &quot;title&quot;</span></code></pre></div>
</div>
<div id="read-the-configuration-file" class="section level2">
<h2>Read the configuration file</h2>
<p><code>read.config</code> can read a configuration file in R and as a list object that can pass parameter to inner read function (fromJSON/read.ini/yaml.load_file/parseToml) accordingly.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Read in R as a list (JSON/INI/YAML/TOML be suported)</span>
<span class="co"># fromJSON/read.ini/readLines/yaml.load  parameters can be automatch by parameter name (encoding .etc.)</span>
<span class="kw">read.config</span>(<span class="dt">file =</span> config.toml)
<span class="co">#&gt; List of 8</span>
<span class="co">#&gt;  $ bash_parse        :List of 2</span>
<span class="co">#&gt;   ..$ parsed: chr &quot;bash&quot;</span>
<span class="co">#&gt;   ..$ raw   : chr &quot;#&gt;#echo bash#&lt;#&quot;</span>
<span class="co">#&gt;  $ comments          :List of 1</span>
<span class="co">#&gt;   ..$ version: chr &quot;0.2.3&quot;</span>
<span class="co">#&gt;  $ default           :List of 1</span>
<span class="co">#&gt;   ..$ debug: chr &quot;{{debug}} {{debug2}}&quot;</span>
<span class="co">#&gt;  $ extra_list_parse  :List of 2</span>
<span class="co">#&gt;   ..$ parsed: chr &quot;1&quot;</span>
<span class="co">#&gt;   ..$ raw   : chr &quot;{{yes}}&quot;</span>
<span class="co">#&gt;  $ glue_parse        :List of 4</span>
<span class="co">#&gt;   ..$ parsed_1: chr [1:10] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; ...</span>
<span class="co">#&gt;   ..$ parsed_2: int [1:10] 1 2 3 4 5 6 7 8 9 10</span>
<span class="co">#&gt;   ..$ raw_1   : chr &quot;!!glue {1:10}&quot;</span>
<span class="co">#&gt;   ..$ raw_2   : chr &quot;!!glue_numeric {1:10}&quot;</span>
<span class="co">#&gt;  $ mulitple_parse    :List of 2</span>
<span class="co">#&gt;   ..$ parsed: chr &quot;configr, configr, yes, 1, config, config, no, 0&quot;</span>
<span class="co">#&gt;   ..$ raw   : chr &quot;@&gt;@str_replace('config','g$','gr')@&lt;@, #&gt;#echo configr#&lt;#, {{key:yes_flag}}, {{yes}}, @&gt;@str_replace('configr',&quot;| __truncated__</span>
<span class="co">#&gt;  $ other_config_parse:List of 2</span>
<span class="co">#&gt;   ..$ parsed: chr &quot;yes no&quot;</span>
<span class="co">#&gt;   ..$ raw   : chr &quot;{{key:yes_flag}} {{key:no_flag}}&quot;</span>
<span class="co">#&gt;  $ title             : chr &quot;TOML Example&quot;</span></code></pre></div>
<p><code>eval.config</code> return a value or a list object containing the file path, config group, filetype as the attribute.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Get the same obj with config package, only get the </span>
<span class="co"># 'default or R_CONFIG_ACTIVE config sets' in config.cfg or R_CONFIGFILE_ACTIVE</span>
<span class="kw">eval.config</span>(<span class="dt">file =</span> config.yaml)
<span class="co">#&gt; $debug</span>
<span class="co">#&gt; [1] &quot;{{debug}} {{debug2}}&quot;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; attr(,&quot;config&quot;)</span>
<span class="co">#&gt; [1] &quot;default&quot;</span>
<span class="co">#&gt; attr(,&quot;configtype&quot;)</span>
<span class="co">#&gt; [1] &quot;yaml&quot;</span>
<span class="co">#&gt; attr(,&quot;file&quot;)</span>
<span class="co">#&gt; [1] &quot;/tmp/Rtmp2yKLg6/Rinst1762b6d95d8ff/configr/extdata/config.yaml&quot;</span>

<span class="co"># Read designated section</span>
<span class="kw">eval.config</span>(<span class="dt">file =</span> config.json, <span class="dt">config =</span> <span class="st">&quot;comments&quot;</span>)
<span class="co">#&gt; $version</span>
<span class="co">#&gt; [1] &quot;0.2.3&quot;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; attr(,&quot;config&quot;)</span>
<span class="co">#&gt; [1] &quot;comments&quot;</span>
<span class="co">#&gt; attr(,&quot;configtype&quot;)</span>
<span class="co">#&gt; [1] &quot;json&quot;</span>
<span class="co">#&gt; attr(,&quot;file&quot;)</span>
<span class="co">#&gt; [1] &quot;/tmp/Rtmp2yKLg6/Rinst1762b6d95d8ff/configr/extdata/config.json&quot;</span>

<span class="co"># Read designated section with its one value</span>
<span class="kw">eval.config</span>(<span class="dt">file =</span> config.ini, <span class="dt">config =</span> <span class="st">&quot;comments&quot;</span>, <span class="dt">value =</span> <span class="st">&quot;version&quot;</span>)
<span class="co">#&gt; [1] &quot;0.2.3&quot;</span></code></pre></div>
<p><code>eval.config.merge</code> will merge multiple sections (equal to <code>config</code> in <code>eval.config</code> function) and reduce the layer of configuration file.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">eval.config.merge</span>(<span class="dt">file =</span> config.json, <span class="dt">sections =</span> <span class="kw">c</span>(<span class="st">'default'</span>, <span class="st">'comments'</span>))
<span class="co">#&gt; $debug</span>
<span class="co">#&gt; [1] &quot;{{debug}} {{debug2}}&quot;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $version</span>
<span class="co">#&gt; [1] &quot;0.2.3&quot;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; attr(,&quot;config&quot;)</span>
<span class="co">#&gt; [1] &quot;default&quot;  &quot;comments&quot;</span>
<span class="co">#&gt; attr(,&quot;configtype&quot;)</span>
<span class="co">#&gt; [1] &quot;json&quot;</span>
<span class="co">#&gt; attr(,&quot;file&quot;)</span>
<span class="co">#&gt; [1] &quot;/tmp/Rtmp2yKLg6/Rinst1762b6d95d8ff/configr/extdata/config.json&quot;</span>
<span class="kw">eval.config.merge</span>(<span class="dt">file =</span> config.toml, <span class="dt">sections =</span> <span class="kw">c</span>(<span class="st">'default'</span>, <span class="st">'comments'</span>))
<span class="co">#&gt; $debug</span>
<span class="co">#&gt; [1] &quot;{{debug}} {{debug2}}&quot;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $version</span>
<span class="co">#&gt; [1] &quot;0.2.3&quot;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; attr(,&quot;config&quot;)</span>
<span class="co">#&gt; [1] &quot;default&quot;  &quot;comments&quot;</span>
<span class="co">#&gt; attr(,&quot;configtype&quot;)</span>
<span class="co">#&gt; [1] &quot;toml&quot;</span>
<span class="co">#&gt; attr(,&quot;file&quot;)</span>
<span class="co">#&gt; [1] &quot;/tmp/Rtmp2yKLg6/Rinst1762b6d95d8ff/configr/extdata/config.toml&quot;</span></code></pre></div>
</div>
<div id="converting-and-writing-configuration-file" class="section level2">
<h2>Converting and writing configuration file</h2>
<p><code>convert.config</code> will read a configuration file and write a configuration file with appointed file type (json. ini, yaml). Moreover, <code>write.config</code> is similar to <code>convert.config</code> but using the list object rather than a file.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Convert YAML configuration file to JSON format</span>
out.json &lt;-<span class="st"> </span><span class="kw">tempfile</span>(, <span class="dt">fileext =</span> <span class="st">&quot;.json&quot;</span>)
<span class="kw">convert.config</span>(<span class="dt">file =</span> config.yaml, <span class="dt">out.file =</span> out.json, <span class="dt">convert.to =</span> <span class="st">&quot;JSON&quot;</span>)
<span class="co">#&gt; [1] TRUE</span>
<span class="kw">get.config.type</span>(out.json)
<span class="co">#&gt; [1] &quot;json&quot;</span>

<span class="co"># Generate a JSON format configuration file</span>
list.test &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">a=</span><span class="kw">c</span>(<span class="dv">123</span>,<span class="dv">456</span>))
out.fn &lt;-<span class="st"> </span><span class="kw">sprintf</span>(<span class="st">&quot;%s/test.json&quot;</span>, <span class="kw">tempdir</span>())
<span class="kw">write.config</span>(<span class="dt">config.dat =</span> list.test, <span class="dt">file.path =</span> out.fn, <span class="dt">write.type =</span> <span class="st">&quot;json&quot;</span>)
<span class="co">#&gt; [1] TRUE</span>
<span class="kw">get.config.type</span>(out.fn)
<span class="co">#&gt; [1] &quot;json&quot;</span>

<span class="co"># Generate a YAML format configuration file with defined indent</span>
<span class="kw">write.config</span>(<span class="dt">config.dat =</span> list.test, <span class="dt">file.path =</span> out.fn, <span class="dt">write.type =</span> <span class="st">&quot;yaml&quot;</span>, <span class="dt">indent =</span> <span class="dv">4</span>)
<span class="co">#&gt; [1] TRUE</span>
<span class="kw">get.config.type</span>(out.fn)
<span class="co">#&gt; [1] &quot;yaml&quot;</span>

<span class="co"># Generate a YAML format configuration file with defined indent and pointed sections</span>
<span class="co">#write.config(config.dat = list.test, file.path = out.fn, write.type = &quot;yaml&quot;, sections = &quot;a&quot;, indent = 4)</span>
<span class="co">#get.config.type(out.fn)</span></code></pre></div>
</div>
<div id="configr-specific-extra-parse" class="section level2">
<h2>Configr specific extra parse</h2>
<p>configr own several userful extra parse function, you can use the <code>parse.extra</code> to finish these work for any list object. Of course, <code>read.config</code>, <code>eval.config</code> and <code>eval.config.merge</code> can directly using <code>parse.extra</code> by passing parameters to <code>parse.extra</code>.</p>
<ul>
<li><code>extra.list</code> can be used to parse the value of <code>{{debug}}</code> to <code>self</code> if you setted <code>extra.list = list(debug = 'self')</code></li>
<li><code>other.config</code> can be used to parse the value of <code>{{key:yes_flag}}</code> to <code>yes</code> if you setted <code>other.config = system.file('extdata', 'config.other.yaml', package='configr')</code> which content can be founded below.</li>
<li><code>rcmd.parse</code> can be used to parse the value of <code>@&gt;@str_replace('config','g$','gr')@&lt;@</code> to <code>configr</code> if you setted <code>rcmd.parse = TRUE</code>.</li>
<li><code>bash.parse</code> can be used to parse the value of <code>#&gt;#echo bash#&lt;#</code> to <code>bash</code> if you setted <code>bash.parse = TRUE</code>.</li>
<li><code>glue.parse</code> can be used to paste the value of <code>!!glue {1:5}</code> to <code>[&quot;1&quot;, &quot;2&quot;, &quot;3&quot;, &quot;4&quot;, &quot;5&quot;]</code>; <code>!!glue_numeric {1:5}</code> to [1, 2, 3, 4, 5]</li>
</ul>
<p><strong>Note:</strong> <code>glue.parse</code> using the <code>glue</code> package <code>glue</code> function to do that. Just like glue(‘{1:5}’) and be processed by unname(unlist(x)). The <code>!!glue</code> can be changed if you setted <code>glue.flag</code>. It is a remarkable fact that only contain the <code>glue.flag</code> character be parsed and the order of item will be changed if the <code>glue</code> result were multiple values. e.g. <code>['{a}', '!!glue {1:5}', '{{a}}']</code> will be parsed to <code>['{a}', '1', '2', '3', '4', '5', '{{a}}']</code></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">other.config &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">'extdata'</span>, <span class="st">'config.other.yaml'</span>, <span class="dt">package=</span><span class="st">'configr'</span>)

<span class="kw">read.config</span>(<span class="dt">file =</span> other.config)
<span class="co">#&gt; $key</span>
<span class="co">#&gt; $key$test_parse</span>
<span class="co">#&gt; [1] 123</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $key$test_parse2</span>
<span class="co">#&gt; [1] 234</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $key$yes_flag</span>
<span class="co">#&gt; [1] &quot;yes&quot;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $key$no_flag</span>
<span class="co">#&gt; [1] &quot;no&quot;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $`samtools@1.3.1`</span>
<span class="co">#&gt; $`samtools@1.3.1`$source_dir</span>
<span class="co">#&gt; [1] &quot;/tmp&quot;</span>

config.<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">read.config</span>(<span class="dt">file =</span> config.json)
config.<span class="dv">1</span><span class="op">$</span>default
<span class="co">#&gt; $debug</span>
<span class="co">#&gt; [1] &quot;{{debug}} {{debug2}}&quot;</span>
<span class="kw">read.config</span>(<span class="dt">file =</span> config.json, <span class="dt">extra.list =</span> <span class="kw">list</span>(<span class="dt">debug =</span> <span class="st">&quot;self&quot;</span>, <span class="dt">debug2 =</span> <span class="st">&quot;self2&quot;</span>))<span class="op">$</span>default
<span class="co">#&gt; $debug</span>
<span class="co">#&gt; [1] &quot;self self2&quot;</span>

sections &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">'default'</span>, <span class="st">'other_config_parse'</span>)
config.<span class="dv">1</span>[sections]
<span class="co">#&gt; $default</span>
<span class="co">#&gt; $default$debug</span>
<span class="co">#&gt; [1] &quot;{{debug}} {{debug2}}&quot;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $other_config_parse</span>
<span class="co">#&gt; $other_config_parse$raw</span>
<span class="co">#&gt; [1] &quot;{{key:yes_flag}} {{key:no_flag}}&quot;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $other_config_parse$parsed</span>
<span class="co">#&gt; [1] &quot;yes no&quot;</span>
<span class="kw">read.config</span>(<span class="dt">file =</span> config.json, <span class="dt">extra.list =</span> <span class="kw">list</span>(<span class="dt">debug =</span> <span class="st">&quot;self&quot;</span>, <span class="dt">debug2 =</span> <span class="st">&quot;self2&quot;</span>), 
  <span class="dt">other.config =</span> other.config)[sections]
<span class="co">#&gt; $default</span>
<span class="co">#&gt; $default$debug</span>
<span class="co">#&gt; [1] &quot;self self2&quot;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $other_config_parse</span>
<span class="co">#&gt; $other_config_parse$raw</span>
<span class="co">#&gt; [1] &quot;yes no&quot;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $other_config_parse$parsed</span>
<span class="co">#&gt; [1] &quot;yes no&quot;</span>

sections &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">'default'</span>, <span class="st">'other_config_parse'</span>, <span class="st">'rcmd_parse'</span>)
<span class="co"># The followed two line command will return the same value</span>
config.<span class="dv">1</span>[sections]
<span class="co">#&gt; $default</span>
<span class="co">#&gt; $default$debug</span>
<span class="co">#&gt; [1] &quot;{{debug}} {{debug2}}&quot;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $other_config_parse</span>
<span class="co">#&gt; $other_config_parse$raw</span>
<span class="co">#&gt; [1] &quot;{{key:yes_flag}} {{key:no_flag}}&quot;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $other_config_parse$parsed</span>
<span class="co">#&gt; [1] &quot;yes no&quot;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $rcmd_parse</span>
<span class="co">#&gt; $rcmd_parse$raw</span>
<span class="co">#&gt; [1] &quot;@&gt;@ Sys.Date() @&lt;@&quot;</span>
<span class="kw">read.config</span>(<span class="dt">file =</span> config.json, <span class="dt">extra.list =</span> <span class="kw">list</span>(<span class="dt">debug =</span> <span class="st">&quot;self&quot;</span>, <span class="dt">debug2 =</span> <span class="st">&quot;self2&quot;</span>), 
  <span class="dt">other.config =</span> other.config, <span class="dt">rcmd.parse =</span> T)[sections]
<span class="co">#&gt; $default</span>
<span class="co">#&gt; $default$debug</span>
<span class="co">#&gt; [1] &quot;self self2&quot;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $other_config_parse</span>
<span class="co">#&gt; $other_config_parse$raw</span>
<span class="co">#&gt; [1] &quot;yes no&quot;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $other_config_parse$parsed</span>
<span class="co">#&gt; [1] &quot;yes no&quot;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $rcmd_parse</span>
<span class="co">#&gt; $rcmd_parse$raw</span>
<span class="co">#&gt; [1] &quot;2017-07-18&quot;</span>
<span class="kw">parse.extra</span>(config.<span class="dv">1</span>, <span class="dt">extra.list =</span> <span class="kw">list</span>(<span class="dt">debug =</span> <span class="st">&quot;self&quot;</span>, <span class="dt">debug2 =</span> <span class="st">&quot;self2&quot;</span>), 
  <span class="dt">other.config =</span> other.config, <span class="dt">rcmd.parse =</span> T)[sections]
<span class="co">#&gt; $default</span>
<span class="co">#&gt; $default$debug</span>
<span class="co">#&gt; [1] &quot;self self2&quot;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $other_config_parse</span>
<span class="co">#&gt; $other_config_parse$raw</span>
<span class="co">#&gt; [1] &quot;yes no&quot;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $other_config_parse$parsed</span>
<span class="co">#&gt; [1] &quot;yes no&quot;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $rcmd_parse</span>
<span class="co">#&gt; $rcmd_parse$raw</span>
<span class="co">#&gt; [1] &quot;2017-07-18&quot;</span>


sections &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">'default'</span>, <span class="st">'other_config_parse'</span>, <span class="st">'rcmd_parse'</span>, <span class="st">'mulitple_parse'</span>)
config.<span class="dv">1</span>[sections]
<span class="co">#&gt; $default</span>
<span class="co">#&gt; $default$debug</span>
<span class="co">#&gt; [1] &quot;{{debug}} {{debug2}}&quot;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $other_config_parse</span>
<span class="co">#&gt; $other_config_parse$raw</span>
<span class="co">#&gt; [1] &quot;{{key:yes_flag}} {{key:no_flag}}&quot;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $other_config_parse$parsed</span>
<span class="co">#&gt; [1] &quot;yes no&quot;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $rcmd_parse</span>
<span class="co">#&gt; $rcmd_parse$raw</span>
<span class="co">#&gt; [1] &quot;@&gt;@ Sys.Date() @&lt;@&quot;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $mulitple_parse</span>
<span class="co">#&gt; $mulitple_parse$raw</span>
<span class="co">#&gt; [1] &quot;@&gt;@str_replace('config','g$','gr')@&lt;@, #&gt;#echo configr#&lt;#, {{key:yes_flag}}, {{yes}}, @&gt;@str_replace('configr','r','')@&lt;@, #&gt;# echo config#&lt;#, {{key:no_flag}}, {{no}}&quot;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $mulitple_parse$parsed</span>
<span class="co">#&gt; [1] &quot;configr, configr, yes, 1, config, config, no, 0&quot;</span>
<span class="kw">parse.extra</span>(config.<span class="dv">1</span>, <span class="dt">extra.list =</span> <span class="kw">list</span>(<span class="dt">debug =</span> <span class="st">&quot;self&quot;</span>, <span class="dt">debug2 =</span> <span class="st">&quot;self2&quot;</span>, <span class="dt">yes =</span> <span class="st">&quot;1&quot;</span>, <span class="dt">no =</span> <span class="st">&quot;0&quot;</span>), 
  <span class="dt">other.config =</span> other.config, <span class="dt">rcmd.parse =</span> T, <span class="dt">bash.parse =</span> T)[sections]
<span class="co">#&gt; $default</span>
<span class="co">#&gt; $default$debug</span>
<span class="co">#&gt; [1] &quot;self self2&quot;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $other_config_parse</span>
<span class="co">#&gt; $other_config_parse$raw</span>
<span class="co">#&gt; [1] &quot;yes no&quot;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $other_config_parse$parsed</span>
<span class="co">#&gt; [1] &quot;yes no&quot;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $rcmd_parse</span>
<span class="co">#&gt; $rcmd_parse$raw</span>
<span class="co">#&gt; [1] &quot;2017-07-18&quot;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $mulitple_parse</span>
<span class="co">#&gt; $mulitple_parse$raw</span>
<span class="co">#&gt; [1] &quot;configr, configr, yes, 1, config, config, no, 0&quot;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $mulitple_parse$parsed</span>
<span class="co">#&gt; [1] &quot;configr, configr, yes, 1, config, config, no, 0&quot;</span>

<span class="co"># glue parse</span>
raw &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;!!glue{1:5}&quot;</span>, <span class="st">&quot;c&quot;</span>)
list.raw &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">glue =</span> raw, <span class="dt">nochange =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>)
list.raw
<span class="co">#&gt; $glue</span>
<span class="co">#&gt; [1] &quot;a&quot;           &quot;!!glue{1:5}&quot; &quot;c&quot;          </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $nochange</span>
<span class="co">#&gt;  [1]  1  2  3  4  5  6  7  8  9 10</span>
expect.parsed.<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;1&quot;</span>, <span class="st">&quot;2&quot;</span>, <span class="st">&quot;3&quot;</span>, <span class="st">&quot;4&quot;</span>, <span class="st">&quot;5&quot;</span>, <span class="st">&quot;c&quot;</span>)
expect.parsed.<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">glue =</span> expect.parsed.<span class="dv">1</span>, <span class="dt">nochange =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>)
<span class="kw">parse.extra</span>(list.raw, <span class="dt">glue.parse =</span> <span class="ot">TRUE</span>, <span class="dt">glue.flag =</span> <span class="st">&quot;!!glue&quot;</span>)
<span class="co">#&gt; $glue</span>
<span class="co">#&gt; [1] &quot;a&quot; &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; &quot;5&quot; &quot;c&quot;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $nochange</span>
<span class="co">#&gt;  [1]  1  2  3  4  5  6  7  8  9 10</span></code></pre></div>
</div>
<div id="others" class="section level2">
<h2>Others</h2>
<p><code>config.section.del</code> can be used to delete a section of config, just do <code>config$section &lt;- NULL</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">config &lt;-<span class="st"> </span><span class="kw">read.config</span>(<span class="dt">file =</span> config.json, <span class="dt">extra.list =</span> <span class="kw">list</span>(<span class="dt">debug =</span> <span class="st">&quot;self&quot;</span>, <span class="dt">debug2 =</span> <span class="st">&quot;self2&quot;</span>), 
  <span class="dt">other.config =</span> other.config)[sections]
<span class="kw">names</span>(config)
<span class="co">#&gt; [1] &quot;default&quot;            &quot;other_config_parse&quot; &quot;rcmd_parse&quot;        </span>
<span class="co">#&gt; [4] &quot;mulitple_parse&quot;</span>
config &lt;-<span class="st"> </span><span class="kw">config.sections.del</span>(config, <span class="st">'default'</span>)
<span class="kw">names</span>(config)
<span class="co">#&gt; [1] &quot;other_config_parse&quot; &quot;rcmd_parse&quot;         &quot;mulitple_parse&quot;</span></code></pre></div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
